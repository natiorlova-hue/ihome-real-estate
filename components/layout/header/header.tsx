import { Button } from "@/components/ui/button";
import {
  DropdownMenu,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuTrigger,
} from "@/components/ui/dropdown-menu";
import { categories } from "@/lib/categories";
import { getTranslations } from "next-intl/server";
import Link from "next/link";
import MobileMenu from "../MobileMenu";
import styles from "./header.module.css";

interface HeaderProps {
  locale: string;
}

export default async function Header({ locale }: HeaderProps) {
  const tNav = await getTranslations({
    locale,
    namespace: "navigation.header",
  });
  const tLifestyle = await getTranslations({
    locale,
    namespace: "taxonomy.categoryLifestyle",
  });

  return (
    <header className="fixed top-0 left-0 w-full z-50 bg-gray-50/90 backdrop-blur-md border-b border-gray-100">
      <div className="container">
        <div className="flex items-center gap-6 h-16 md:h-20 justify-between">
          {/* Logo */}
          <Link
            href={`/${locale}`}
            className={styles.logo}
            aria-label="iHome Homepage"
          >
            <svg
              viewBox="0 0 35 35"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
              className="w-8 h-8 xl:w-9 xl:h-9"
              // LCP Optimization: Logo is critical
            >
              <path
                d="M17.0789 1C25.9755 0.925903 33.3998 8.08074 33.4344 17.2002V17.2021C33.4223 26.1198 26.2799 33.3142 17.4285 33.4268C8.4059 33.5408 1.17476 26.3337 1.00374 17.543C0.827478 8.46081 8.11309 1.07512 17.0789 1ZM16.9451 4.68457C16.8465 4.70166 16.7551 4.73245 16.6883 4.77344C15.916 5.24723 15.1489 5.72649 14.3953 6.22363C13.8482 6.58462 13.2734 6.9921 12.6131 7.25391C12.1599 7.43367 11.6877 7.54104 11.1893 7.53516L10.9735 7.52539C10.7924 7.51133 10.612 7.51694 10.451 7.55078C9.97742 7.65077 9.55631 7.89759 9.14046 8.20801C8.51609 8.67359 7.878 9.14462 7.18733 9.54688C6.40558 10.0022 5.57951 10.4915 4.63264 10.7061C4.4919 10.7379 4.40499 10.7856 4.34065 10.8438C4.27342 10.9046 4.21259 10.9924 4.14827 11.1328C3.0582 13.5131 2.64007 16.003 2.87776 18.6064C2.98424 19.7743 3.23912 20.9132 3.63362 22.0195C4.42916 24.2501 5.69689 26.1711 7.4305 27.7832C8.53936 28.8141 9.78458 29.6467 11.16 30.2852C12.8447 31.0672 14.6154 31.5042 16.4686 31.5986C17.7615 31.6644 19.0419 31.5639 20.3065 31.2832C23.0081 30.683 25.3436 29.4102 27.3201 27.4775C28.5913 26.2347 29.5914 24.7972 30.3299 23.1777C31.0712 21.5522 31.4891 19.845 31.5955 18.0615C31.6609 16.9659 31.5985 15.8752 31.4149 14.791C31.1652 13.3165 30.6948 11.9162 30.0037 10.5908C30.0002 10.5882 29.9946 10.5852 29.9891 10.582C29.9831 10.5785 29.9764 10.5749 29.9705 10.5723C29.8502 10.5187 29.7283 10.4732 29.5916 10.4189C29.4599 10.3667 29.3181 10.3077 29.1815 10.2324C28.6536 9.94149 28.1291 9.61694 27.6199 9.32129C27.1269 9.03467 26.6898 8.77543 26.1824 8.68848C25.614 8.59101 25.1157 8.33818 24.6991 7.94141C24.4453 7.69954 24.193 7.4532 23.9461 7.20215C23.7518 7.00473 23.526 6.92231 23.2498 6.94141C22.9543 6.96195 22.6589 6.9858 22.366 7.01465C22.2359 7.02742 22.1062 7.0432 21.9735 7.05859C22.2106 7.30891 22.4573 7.56626 22.6854 7.83105C23.0329 8.23432 23.4309 8.56537 23.8914 8.82129L23.8934 8.82324C23.8951 8.82401 23.8983 8.82486 23.9012 8.82617C23.9078 8.82919 23.917 8.83356 23.9276 8.83789C23.9499 8.84698 23.9794 8.85825 24.0125 8.87012C24.0794 8.89405 24.1603 8.92041 24.244 8.94824C24.3262 8.97556 24.4132 9.00478 24.4871 9.03125C24.5549 9.05556 24.6336 9.08582 24.6883 9.11621L25.4295 9.52734L24.5867 9.62305C24.4779 9.63528 24.3518 9.6268 24.2723 9.62109C24.257 9.62 24.2431 9.61904 24.2313 9.61816H24.1453C24.0542 9.61816 23.9158 9.61741 23.7908 9.58691V9.58594C23.2174 9.44606 22.5838 9.28675 22.0467 8.875C21.6989 8.60792 21.3433 8.33728 20.9998 8.05273C20.6439 7.75817 20.2549 7.54962 19.8114 7.43066V7.42969C19.4684 7.33776 19.0381 7.223 18.7098 6.88477H18.7088C18.3274 6.49094 17.9526 6.09972 17.5643 5.72363C17.4486 5.61161 17.3546 5.48453 17.2957 5.33496C17.2367 5.18438 17.2192 5.02471 17.2342 4.85645C17.2423 4.76609 17.216 4.72528 17.2 4.70898C17.1835 4.69254 17.1407 4.66476 17.0467 4.67188L16.9451 4.68457ZM14.5692 10.4619C14.6929 10.4597 14.8296 10.4818 14.9471 10.5703C15.0649 10.6592 15.124 10.7846 15.1551 10.9043L15.1834 11.0576C15.1895 11.113 15.1907 11.172 15.1844 11.2314V11.2324C15.1683 11.3811 15.1245 11.5435 14.9959 11.6641C14.8685 11.7831 14.7052 11.8168 14.5584 11.8262H14.5574C14.4381 11.8337 14.3369 11.8365 14.241 11.8398L13.9559 11.8594C13.7262 11.8881 13.5035 11.9247 13.2918 11.9814C13.1833 12.0105 13.1148 12.059 13.0721 12.1133C13.0396 12.1548 13.0136 12.2111 12.9998 12.2852L12.9901 12.3652C12.9611 12.9149 12.9336 13.4592 12.9295 14.002C12.9204 15.2222 12.9266 16.4425 12.9266 17.666V17.6953C15.7976 17.7222 18.641 17.7423 21.4901 17.707L21.4823 12.7041C21.4819 12.6347 21.475 12.5625 21.4627 12.4873L21.4139 12.249C21.3755 12.0844 21.2817 11.996 21.1385 11.9697C20.808 11.9089 20.4763 11.8783 20.1219 11.835C20.0968 11.8319 20.0672 11.8304 20.0282 11.8301L19.8953 11.8281C19.6358 11.8175 19.4117 11.6903 19.2918 11.4785C19.1723 11.2672 19.1781 11.0092 19.2987 10.7793C19.3974 10.5914 19.5784 10.4571 19.8231 10.4639C20.2954 10.4768 20.7713 10.4929 21.241 10.5068C21.4024 10.5115 21.5581 10.516 21.7127 10.5146H21.7137C22.8523 10.5064 23.9906 10.4979 25.1287 10.4863C25.2278 10.4853 25.3284 10.4802 25.4344 10.4746C25.5385 10.4692 25.6493 10.4637 25.7606 10.4619C25.9325 10.4593 26.1113 10.4975 26.2489 10.624C26.3872 10.7515 26.4373 10.926 26.4451 11.0947C26.4533 11.2724 26.4214 11.4596 26.2967 11.6064C26.2015 11.7182 26.0761 11.7788 25.9442 11.8076L25.8114 11.8262C25.5063 11.8486 25.2386 11.8564 24.9559 11.8867C24.8071 11.9027 24.6541 11.9406 24.4862 11.9854C24.3913 12.0106 24.3353 12.0557 24.3065 12.1162L24.286 12.1816C24.2382 12.4612 24.1977 12.725 24.1971 12.9814C24.1913 16.9171 24.1913 20.8534 24.1971 24.7891C24.1973 25.0148 24.2404 25.2448 24.285 25.5059C24.3058 25.6279 24.3689 25.6864 24.4676 25.7041C24.7947 25.7629 25.1262 25.7998 25.4705 25.8408L25.6678 25.8535L25.91 25.8682C26.0829 25.8887 26.2346 25.9739 26.3328 26.1211C26.4253 26.2598 26.4529 26.4276 26.4451 26.5898C26.4377 26.742 26.3936 26.9 26.286 27.0234C26.1722 27.1536 26.0139 27.2149 25.8446 27.2139C25.2718 27.2101 24.7642 27.1839 24.2078 27.1855C22.8589 27.1894 21.5109 27.2039 20.16 27.2139C20.0847 27.2144 20.0096 27.2141 19.9364 27.2139C19.6775 27.2129 19.4341 27.1135 19.3006 26.8945C19.1683 26.6772 19.1883 26.4144 19.2996 26.1816C19.3446 26.0879 19.4114 26.0052 19.5037 25.9463C19.5953 25.8881 19.6963 25.863 19.7928 25.8584L20.2332 25.8398C20.3765 25.8332 20.5174 25.8243 20.659 25.8105C20.84 25.793 21.025 25.7565 21.2098 25.708C21.3358 25.6749 21.3926 25.6064 21.4051 25.5078C21.4515 25.1397 21.4977 24.7919 21.4998 24.4473C21.5096 22.7393 21.5049 21.0311 21.5047 19.3213H12.9168C12.9185 19.4577 12.9207 19.6039 12.9207 19.7432C12.921 21.3739 12.9201 23.0048 12.9237 24.6348C12.9242 24.8518 12.9377 25.0712 12.9647 25.2871C12.9922 25.506 13.043 25.6 13.0965 25.6514C13.1525 25.7049 13.2587 25.7572 13.4989 25.7852C13.8483 25.8258 14.1965 25.837 14.5682 25.8594C14.7101 25.868 14.8768 25.9 15.0028 26.0254C15.0975 26.12 15.1397 26.2383 15.158 26.3525L15.1698 26.4658L15.1658 26.666V26.667C15.1545 26.8046 15.1108 26.955 14.991 27.0674C14.87 27.1806 14.7154 27.2134 14.5731 27.2129C14.0112 27.2104 13.4762 27.1998 12.9207 27.1992C11.9853 27.1984 11.0498 27.202 10.1131 27.2051C9.62241 27.2067 9.11858 27.2129 8.62386 27.2129C8.46291 27.2128 8.28531 27.1789 8.15218 27.0449C8.02108 26.9128 7.98628 26.7359 7.98225 26.5781L7.98323 26.5771C7.97899 26.4064 7.99812 26.2192 8.11214 26.0713C8.23518 25.9119 8.41595 25.8609 8.58186 25.8477L9.701 25.7568C9.7829 25.7488 9.87124 25.7249 9.95589 25.6904C10.0879 25.6365 10.1433 25.5222 10.1854 25.2637C10.2172 25.0696 10.2303 24.867 10.2303 24.6641C10.2331 20.8293 10.2331 16.993 10.2303 13.1582C10.2303 12.9136 10.2248 12.681 10.1903 12.46C10.1526 12.2198 10.0986 12.1158 10.0408 12.0586C9.98327 12.0016 9.87986 11.9495 9.64143 11.915C9.31896 11.8686 8.98912 11.8458 8.65218 11.8271H8.6512C8.55827 11.8219 8.43582 11.8084 8.3221 11.75C8.19487 11.6846 8.10069 11.5756 8.05061 11.4268V11.4258C7.97838 11.2097 7.93528 10.8923 8.18147 10.6357L8.23616 10.5879C8.29222 10.5454 8.35301 10.5181 8.40413 10.501C8.47509 10.4773 8.5523 10.4646 8.62483 10.4648C8.82684 10.4654 9.02887 10.4712 9.22542 10.4775C9.42307 10.484 9.61614 10.4909 9.80843 10.4912C11.1437 10.4934 12.4795 10.4898 13.8153 10.4854C13.9354 10.485 14.0573 10.4801 14.1834 10.4746C14.3077 10.4692 14.4379 10.4642 14.5682 10.4619H14.5692ZM15.1903 6.9082C15.1747 6.94438 15.1677 6.96593 15.1541 7C15.1427 7.02858 15.1225 7.07515 15.0897 7.12109C14.7576 7.58532 14.425 8.05693 14.0828 8.51953C13.8526 8.8303 13.522 8.98497 13.2283 9.08887C12.7035 9.27453 12.1733 9.44936 11.6502 9.62695L11.6541 9.625L11.6512 9.62598C11.65 9.62647 11.6479 9.62708 11.6463 9.62793H11.6483L11.6453 9.62891C11.6355 9.63434 11.6169 9.64538 11.5975 9.65527C11.5776 9.6654 11.5506 9.67857 11.5213 9.68945C11.4933 9.69979 11.4501 9.71286 11.4012 9.7168L10.6033 9.78125L11.1981 9.24512C11.2438 9.20386 11.2983 9.14263 11.3817 9.05664C11.4499 8.98628 11.5494 8.88696 11.6492 8.8291C12.2571 8.47824 12.7533 7.98759 13.2742 7.46387C13.6493 7.08703 14.0878 6.79727 14.5741 6.59082V6.58984C14.6476 6.5586 14.7202 6.54967 14.7684 6.54492C14.8093 6.54091 14.8354 6.53885 14.8631 6.53613L15.4852 6.22559L15.1903 6.9082ZM17.075 2.8125C11.4682 2.86569 7.22866 6.07655 5.1385 9.37012C6.07437 8.87574 6.96486 8.31196 7.78987 7.65137C8.3641 7.19149 8.9745 6.71963 9.72151 6.44629C9.76722 6.42956 9.81391 6.41074 9.86409 6.39062C9.91321 6.37093 9.96742 6.34928 10.0213 6.3291C10.1288 6.28886 10.2517 6.24876 10.3836 6.22949C10.7201 6.18047 11.0812 6.18211 11.3826 6.16504C11.7986 6.14152 12.11 6.14877 12.3856 6C12.7771 5.7885 13.1563 5.54746 13.5408 5.2998L14.7752 4.50098C15.1853 4.23349 15.5944 3.96436 16.0018 3.69336L16.1502 3.60449C16.9144 3.19826 18.0014 3.324 18.6444 3.96289C18.9069 4.22392 19.1761 4.48074 19.4471 4.73828C19.7174 4.99514 19.9912 5.2549 20.2596 5.51855H20.2606C20.4921 5.74571 20.7484 5.8408 21.0545 5.81152C21.6041 5.75897 22.1449 5.70909 22.6795 5.62891H22.6805C23.4633 5.51174 24.1596 5.6987 24.7996 6.12988C25.6449 6.6995 26.5008 7.25647 27.3592 7.81055C27.58 7.95307 27.8064 8.09017 28.036 8.22852C28.2645 8.3662 28.4983 8.50607 28.7274 8.65234C28.7712 8.68035 28.8146 8.71052 28.8582 8.73926C26.6667 5.68789 22.5117 2.76132 17.075 2.8125Z"
                fill="#EF651A"
              />
            </svg>
            <span className="text-base xl:text-xl">{"IHome âˆ™ Marbella"}</span>
          </Link>

          {/* Desktop Nav */}
          <nav className="hidden xl:flex items-center gap-6 font-semibold">
            <Link
              href={`/${locale}`}
              className="text-gray-700 hover:text-terracotta-500 transition-colors"
            >
              {tNav("nav.home")}
            </Link>

            <DropdownMenu>
              <DropdownMenuTrigger asChild>
                <Link
                  href={`/${locale}/properties`}
                  className="flex items-center gap-1 cursor-pointer text-gray-700 hover:text-terracotta-500 transition-colors"
                >
                  {tNav("nav.forYou")}
                </Link>
              </DropdownMenuTrigger>
              <DropdownMenuContent className="w-[344px]">
                {categories.map(item => (
                  <DropdownMenuItem key={item.key} className="px-4 py-2">
                    <Link
                      href={`/${locale}/${item.path}`}
                      className="flex gap-3 w-full"
                    >
                      <span className="flex-shrink-0">{item.icon}</span>
                      <div className="flex flex-col">
                        <span className="text-md font-semibold">
                          {tLifestyle(`${item.key}.title`)}
                        </span>
                        <span className="text-tertiary-600 text-sm">
                          {tLifestyle(`${item.key}.desc`)}
                        </span>
                      </div>
                    </Link>
                  </DropdownMenuItem>
                ))}
              </DropdownMenuContent>
            </DropdownMenu>

            <Link
              href={`/${locale}/properties`}
              className="text-gray-700 hover:text-terracotta-500 transition-colors"
            >
              {tNav("nav.properties")}
            </Link>

            <Link
              href={`/${locale}/guides`}
              className="text-gray-700 hover:text-terracotta-500 transition-colors"
            >
              {tNav("nav.guides")}
            </Link>

            <Link
              href={`/${locale}/our-way`}
              className="text-gray-700 hover:text-terracotta-500 transition-colors"
            >
              {tNav("nav.ourWay")}
            </Link>
          </nav>

          {/* Right Side Actions */}
          <div className="hidden xl:flex items-center gap-4">
            <Button asChild variant="outline">
              <Link href={`/${locale}/contact`}>{tNav("actions.method")}</Link>
            </Button>

            <Button asChild>
              <Link href={`/${locale}/contact`}>{tNav("actions.talk")}</Link>
            </Button>
          </div>

          {/* Mobile Nav Toggle */}
          <MobileMenu />
        </div>
      </div>
    </header>
  );
}
